{"code":"_N_E=(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[11],{\"72o5\":function(e,t,r){\"use strict\";r.r(t),r.d(t,\"default\",(function(){return P}));var n=r(\"KQm4\"),a=r(\"o0o1\"),s=r.n(a),u=r(\"1OyB\"),c=r(\"vuIU\"),i=r(\"rePB\");function o(e,t,r,n,a,s,u){try{var c=e[s](u),i=c.value}catch(o){return void r(o)}c.done?t(i):Promise.resolve(i).then(n,a)}function l(e){return function(){var t=this,r=arguments;return new Promise((function(n,a){var s=e.apply(t,r);function u(e){o(s,n,a,u,c,\"next\",e)}function c(e){o(s,n,a,u,c,\"throw\",e)}u(void 0)}))}}var p=r(\"ODXe\"),y=r(\"q1tI\"),d=r(\"bgFo\"),f=function(){var e=l(s.a.mark((function e(t){var r,n,a,u,c,i,o;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.location,n=t.radius,a=t.startFormatted,u=t.endFormatted,e.prev=1,e.next=4,fetch(\"http://localhost:3000/api/ticketmasterAPI\",{headers:{Accept:\"application/json\",\"Content-Type\":\"application/json\"},method:\"POST\",body:JSON.stringify({location:r,radius:Math.floor(.001*parseInt(n)).toString(),startDateTime:a,endDateTime:u})});case 4:return c=e.sent,e.next=7,c.json();case 7:return i=e.sent,(o=i._embedded.events).forEach((function(e){return e.source=\"ticketmaster\",e.type=\"event\",e.inParts=!1})),e.abrupt(\"return\",o);case 13:return e.prev=13,e.t0=e.catch(1),e.abrupt(\"return\",e.t0.message);case 16:case\"end\":return e.stop()}}),e,null,[[1,13]])})));return function(t){return e.apply(this,arguments)}}(),h=function(){var e=l(s.a.mark((function e(t){var r,n,a,u,c,i;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.location,n=t.radius,a=t.placeType,e.prev=1,e.next=4,fetch(\"http://localhost:3000/api/yelpBusinessesAPI\",{headers:{Accept:\"application/json\",\"Content-Type\":\"application/json\"},method:\"POST\",body:JSON.stringify({location:r,radius:parseInt(n),term:a})});case 4:return u=e.sent,e.next=7,u.json();case 7:return c=e.sent,(i=c.businesses).forEach((function(e){return e.type=\"place\",e.source=\"yelp\",e.inParts=!1})),e.abrupt(\"return\",i);case 13:return e.prev=13,e.t0=e.catch(1),e.abrupt(\"return\",e.t0.message);case 16:case\"end\":return e.stop()}}),e,null,[[1,13]])})));return function(t){return e.apply(this,arguments)}}(),m=function(){var e=l(s.a.mark((function e(t){var r,n,a,u,c,i,o;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.location,n=t.radius,a=t.unixStartDate,u=t.unixEndDate,t.categories,e.prev=1,e.next=4,fetch(\"http://localhost:3000/api/yelpEventsAPI\",{headers:{Accept:\"application/json\",\"Content-Type\":\"application/json\"},method:\"POST\",body:JSON.stringify({location:r,radius:parseInt(n),start_date:parseInt(a),end_date:parseInt(u)})});case 4:return c=e.sent,e.next=7,c.json();case 7:return i=e.sent,(o=i.events).forEach((function(e){return e.type=\"event\",e.source=\"yelp\",e.inParts=!1})),e.abrupt(\"return\",o);case 13:return e.prev=13,e.t0=e.catch(1),e.abrupt(\"return\",e.t0.message);case 16:case\"end\":return e.stop()}}),e,null,[[1,13]])})));return function(t){return e.apply(this,arguments)}}(),v=r(\"nOHt\"),E=r(\"BJjR\"),b=r.n(E),A=y.createElement;function P(e){var t=e.results,r=t.items,n=(t.errors,e.searchType),a=y.useState({resultsType:\"\"}),s=Object(p.a)(a,2),u=s[0],c=s[1],i=Object(v.useRouter)();console.log(i),console.log(r);return A(d.b,null,A(\"main\",{className:b.a.queriedPage},A(\"section\",{className:b.a.header},function(){if(!n)return A(y.Fragment,null,A(\"button\",{className:b.a.typeButton,onClick:function(){return c({resultsType:\"PLACES\"})}},\"Places\"),A(\"button\",{className:b.a.typeButton,onClick:function(){return c({resultsType:\"EVENTS\"})}},\"Events\"));switch(n){case\"ALL\":return A(y.Fragment,null,A(\"button\",{className:b.a.typeButton,onClick:function(){return c({resultsType:\"PLACES\"})}},\"Places\"),A(\"button\",{className:b.a.typeButton,onClick:function(){return c({resultsType:\"EVENTS\"})}},\"Events\"));case\"PLACES\":return A(\"button\",{className:b.a.typeButton,onClick:function(){return c({resultsType:\"PLACES\"})}},\"Places\");case\"EVENTS\":return A(\"button\",{className:b.a.typeButton,onClick:function(){return c({resultsType:\"EVENTS\"})}},\"Events\");default:return A(y.Fragment,null,A(\"button\",{className:b.a.typeButton,onClick:function(){return c({resultsType:\"PLACES\"})}},\"Places\"),A(\"button\",{className:b.a.typeButton,onClick:function(){return c({resultsType:\"EVENTS\"})}},\"Events\"))}}(),A(\"button\",{className:b.a.sort},\"Sort\")),A(\"div\",{className:b.a.resultsSlider},function(){if(!r)return null;switch(n){case\"ALL\":return Array.isArray(r.places)&&Array.isArray(r.events)?\"PLACES\"===u.resultsType?r.places.map((function(e){return A(d.c,{key:e.id,item:e})})):r.events.map((function(e){return A(d.c,{key:e.id,item:e})})):null;case\"PLACES\":return Array.isArray(r.places)?r.places.map((function(e){return A(d.c,{key:e.id,item:e})})):null;case\"EVENTS\":return Array.isArray(r.events)?r.events.map((function(e){return A(d.c,{key:e.id,item:e})})):null;default:return Array.isArray(r.places)&&Array.isArray(r.events)?\"PLACES\"===u.resultsType?r.places.map((function(e){return A(d.c,{key:e.id,item:e})})):r.events.map((function(e){return A(d.c,{key:e.id,item:e})})):null}}())))}P.getInitialProps=function(){var e=l(s.a.mark((function e(t){var r,a,o,p,y,d,v,E,b,A,P,k,T,x,S,_;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.query,t.pathname,t.asPath,a=r.searchType,o=r.location,p=r.radius,y=r.placeType,d=r.startFormatted,v=r.endFormatted,E=r.unixStartDate,b=r.unixEndDate,A=r.eventsCategory,!(o&&p&&d&&v)){e.next=12;break}return console.log(\"api call\"),P=function(){function e(t){Object(u.a)(this,e),Object(i.a)(this,\"searchParams\",void 0),Object(i.a)(this,\"results\",void 0),this.searchParams=t,this.results={items:{places:[],events:[]},errors:{yelpPlaces:\"\",yelpEvents:\"\",ticketmaster:\"\"}}}return Object(c.a)(e,[{key:\"yelpBusinesses\",value:function(){var e=l(s.a.mark((function e(){var t,r,n,a,u;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.searchParams,r=t.location,n=t.radius,a=t.placeType,e.next=3,h({location:r,radius:n,placeType:a});case 3:u=e.sent,Array.isArray(u)?this.results.items.places=u:this.results.errors.yelpPlaces=\"\".concat(u);case 5:case\"end\":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:\"yelpEvents\",value:function(){var e=l(s.a.mark((function e(){var t,r,a,u,c,i;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.searchParams,r=t.location,a=t.radius,u=t.unixStartDate,c=t.unixEndDate,e.next=3,m({location:r,radius:a,unixStartDate:u,unixEndDate:c});case 3:i=e.sent,Array.isArray(i)?this.results.items.events=[].concat(Object(n.a)(this.results.items.events),Object(n.a)(i)):this.results.errors.yelpEvents=\"\".concat(i);case 5:case\"end\":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:\"ticketMaster\",value:function(){var e=l(s.a.mark((function e(){var t,r,a,u,c,i;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.searchParams,r=t.location,a=t.radius,u=t.startFormatted,c=t.endFormatted,e.next=3,f({location:r,radius:a,startFormatted:u,endFormatted:c});case 3:i=e.sent,Array.isArray(i)?this.results.items.events=[].concat(Object(n.a)(this.results.items.events),Object(n.a)(i)):this.results.errors.ticketmaster=\"\".concat(i);case 5:case\"end\":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}(),k=function(){var e=l(s.a.mark((function e(t){var r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=new P({location:o,radius:p,placeType:y,startFormatted:d,endFormatted:v,unixStartDate:E,unixEndDate:b,eventsCategory:A}),e.prev=1,e.t0=t,e.next=\"PLACES\"===e.t0?5:\"EVENTS\"===e.t0?7:\"ALL\"===e.t0?10:14;break;case 5:return r.yelpBusinesses(),e.abrupt(\"return\",r.results);case 7:return r.yelpEvents(),r.ticketMaster(),e.abrupt(\"return\",r.results);case 10:case 14:return r.yelpBusinesses(),r.yelpEvents(),r.ticketMaster(),e.abrupt(\"return\",r.results);case 18:e.next=26;break;case 20:return e.prev=20,e.t1=e.catch(1),r.results.errors.yelpPlaces=\"CALL ERROR\",r.results.errors.yelpEvents=\"CALL ERROR\",r.results.errors.ticketmaster=\"CALL ERROR\",e.abrupt(\"return\",r.results);case 26:case\"end\":return e.stop()}}),e,null,[[1,20]])})));return function(t){return e.apply(this,arguments)}}(),e.next=8,k(a);case 8:return T=e.sent,e.abrupt(\"return\",{results:T,searchType:a});case 12:return x=r.queried.toString(),S=x.split(\"+\"),_={},S.forEach((function(e){var t=e.search(\"=\");if(-1!==t){var r=e.substring(0,t),n=e.substring(t+1);_[r]=n}})),e.abrupt(\"return\",{results:{error:\"BadCall\"},searchType:\"ALL\"});case 17:case\"end\":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},BJjR:function(e,t,r){e.exports={queriedPage:\"Queried_queriedPage__2Rcjt\",queryDisplay:\"Queried_queryDisplay__2jitW\",header:\"Queried_header__2wmM2\",typeButton:\"Queried_typeButton__19BJ8\",sort:\"Queried_sort__EipTf\",resultsSlider:\"Queried_resultsSlider__IHQxp\"}},pq6B:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push([\"/search/[queried]\",function(){return r(\"72o5\")}])}},[[\"pq6B\",1,2,0,3,4]]]);","extractedComments":[]}